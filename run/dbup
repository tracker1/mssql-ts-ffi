#!/usr/bin/env bash
set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_ROOT="$(cd "$SCRIPT_DIR/.." && pwd)"

echo "Starting MSSQL service..."
docker compose -f "$PROJECT_ROOT/docker-compose.yml" up -d

echo "Waiting for MSSQL to be healthy..."
until docker compose -f "$PROJECT_ROOT/docker-compose.yml" ps --format json | grep -q '"Health":"healthy"'; do
  sleep 2
done

echo "MSSQL is ready on localhost:1433"
